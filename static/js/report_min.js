const fileModal=new bootstrap.Modal(document.getElementById("fileModal"));function validateForm(form){const infoInput=document.getElementById("info-input");const email=infoInput.value.trim();const textInput=document.getElementById("text-input");const text=textInput.value.trim();if(!text){flashMessage("请输入您的问题或反馈");textInput.focus();return false}if(email&&!isEmail(email)){flashMessage("请输入有效的电子邮箱地址");infoInput.focus();return false}return true}function isEmail(email){const re=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return re.test(email)}async function flashMessage(text){const flashes=document.getElementById("flashes");const flash=document.createElement("li");flash.textContent=text;flashes.appendChild(flash);setTimeout(()=>{flashes.children[0].remove()},5e3)}function prevFile(){if(currentFileIndex>0){currentFileIndex--;updateModalContent()}}function nextFile(){if(currentFileIndex<currentFiles.length-1){currentFileIndex++;updateModalContent()}}function openFileViewer(files,startIndex){currentFiles=files;currentFileIndex=startIndex;updateModalContent();fileModal.show();document.querySelector(".btn-prev").style.display=files.length>1?"block":"none";document.querySelector(".btn-next").style.display=files.length>1?"block":"none"}function updateModalContent(){const content=document.getElementById("modalContent");const existingMedia=content.querySelector("video,audio,img");if(existingMedia){existingMedia.pause?.();existingMedia.remove()}const file=currentFiles[currentFileIndex];const ext=file.split(".").pop().toLowerCase();const filePath=`/static/uploads/${file}`;if(["png","jpg","jpeg","gif"].includes(ext)){const img=document.createElement("img");img.src=filePath;img.alt=file;img.style.width="100vw";img.style.height="100vh";img.style.objectFit="contain";content.appendChild(img)}else if(["mp4","avi","mov","webm"].includes(ext)){const video=document.createElement("video");video.src=filePath;video.controls=true;video.autoplay=true;video.playsInline=true;video.style.width="100vw";video.style.height="100vh";video.innerHTML=`<source src="${filePath}" type="video/mp4">您的浏览器不支持视频播放`;content.appendChild(video)}else if(["mp3","wav","aac","flac","m4a"].includes(ext)){const audio=document.createElement("audio");audio.src=filePath;audio.controls=true;audio.autoplay=true;audio.style.width="100%";content.appendChild(audio)}else{const link=document.createElement("a");link.href=filePath;link.target="_blank";link.className="text-white";link.textContent=`下载文件: ${file}`;content.appendChild(link)}}function showModal(imageSrc){const modal=document.getElementById("Modal");const modalImage=document.getElementById("modalImage");modalImage.src=imageSrc;modal.style.display="flex"}document.getElementById("fileModal").addEventListener("hidden.bs.modal",function(){const modalContent=document.getElementById("modalContent");if(modalContent){modalContent.innerHTML=``}});